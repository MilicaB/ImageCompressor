(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     47498,       1159]
NotebookOptionsPosition[     46521,       1128]
NotebookOutlinePosition[     46864,       1143]
CellTagsIndexPosition[     46821,       1140]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"QRDec", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"Length", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Q", "=", 
     RowBox[{"Transpose", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"R", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "\[LessEqual]", "n"}], ",", " ", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", " ", 
          RowBox[{"j", "<", "i"}], ",", " ", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"Q", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", 
              RowBox[{"Q", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", 
          RowBox[{"R", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}]}]}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Transpose", "[", "Q", "]"}], ",", "R"}], "}"}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QRAlg", "[", 
   RowBox[{"a_", ",", "\[Epsilon]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"br", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"b", "=", "a"}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", 
     RowBox[{"Length", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"IdentityMatrix", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"q", "=", 
     RowBox[{"r", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "k"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "-", "1"}], ")"}], "^", 
           "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], "]"}], 
       "\[GreaterEqual]", "\[Epsilon]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q", ",", "r"}], "}"}], "=", 
        RowBox[{"QRDec", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"r", ".", "q"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"s", ".", "q"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"br", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "r", ",", "s", ",", "br"}], "}"}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QR", "[", 
   RowBox[{"A_", ",", "\[Epsilon]_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rows", "=", 
     RowBox[{"Length", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cols", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"rows", "\[GreaterEqual]", "cols"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"B", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "A", "]"}], ".", "A"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"QRAlg", "[", 
          RowBox[{"B", ",", "\[Epsilon]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"B", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "cols"}], "}"}]}], "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "rows", ",", "cols", 
          ",", "flag"}], "}"}]}], "\[IndentingNewLine]", ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flag", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{"A", ".", 
          RowBox[{"Transpose", "[", "A", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"QRAlg", "[", 
          RowBox[{"B", ",", "\[Epsilon]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"B", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "rows"}], "}"}]}], "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "rows", ",", "cols", 
          ",", "flag"}], "}"}]}], "\[IndentingNewLine]", ")"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewSVD", "[", 
   RowBox[{
   "A_", ",", "B_", ",", "eigenvalues_", ",", "eigenvectors_", ",", "rows_", 
    ",", "cols_", ",", "flag_", ",", "percent_"}], "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:0440\:0430\:043d\:0435",
     " ", "\:043d\:0430", " ", "\:043c\:0430\:0442\:0440\:0438\:0446\:0430", 
    " ", "\:0441\:044a\:0441", " ", 
    "\:0437\:0430\:0434\:0430\:0434\:0435\:043d\:0430", " ", 
    "\:0442\:043e\:0447\:043d\:043e\:0441\:0442"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"flag", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonzeroVal", "=", "0"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:0431\:0440\:043e\:044f\:0447", " ", "\:0437\:0430", " ", 
         "\:043d\:0435\:043d\:0443\:043b\:0435\:0432\:0438\:0442\:0435", " ", 
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
         "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
         "\:043d\:0430", " ", "newA"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", "cols"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eigenvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", " ", 
           RowBox[{"nonzeroVal", "++"}]}], "]"}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "nonzeroVal"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"saved", "=", 
        RowBox[{"nonzeroVal", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"percent", "/", "100"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:0431\:0440\:043e\:044f\:0442", " ", "\:043d\:0430", " ", 
         "\:0437\:0430\:043f\:0430\:0437\:0430\:043d\:0438\:0442\:0435", " ", 
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
         "\:0432\:0435\:043a\:0442\:043e\:0440\:0438", " ", 
         RowBox[{"(", 
          RowBox[{
          "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:044f\:0442\:0430\
", " ", "\:043d\:0430", " ", "A"}], ")"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"singular", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"eigenvalues", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:043f\:0430\:0437\:0435\:043d\:0438\:0442\:0435", " ", 
         "\:0441\:0438\:043d\:0433\:0443\:043b\:044f\:0440\:043d\:0438", " ", 
         "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
         "\:043d\:0430", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
         "\:0440\:0435\:0434\:043e\:0432\:0435", " ", "\:043d\:0430", " ", 
         "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "V", 
         " ", "\:043e\:0442", " ", 
         "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "saved"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{
           RowBox[{"eigenvectors", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"Norm", "[", 
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"\:0441\:0430\:043c\:0430\:0442\:0430", " ", "V"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"U", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
         "\:043a\:043e\:043b\:043e\:043d\:0438", " ", "\:043d\:0430", " ", 
         "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "U", 
         " ", "\:043e\:0442", " ", 
         "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "saved"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"singular", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"A", ".", 
             RowBox[{"V", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "U"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", 
         "cols", ",", "flag"}], "}"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:0444\:0438\:043d\:0430\:043b\:043d\:0438\:0442\:0435", " ", 
         "\:0434\:0430\:043d\:043d\:0438"}], ",", " ", 
        RowBox[{
        "\:043a\:043e\:0438\:0442\:043e", " ", 
         "\:043f\:0430\:0437\:0438\:043c"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", ")"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonzeroVal", "=", "0"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:0431\:0440\:043e\:044f\:0447", " ", "\:0437\:0430", " ", 
         "\:043d\:0435\:043d\:0443\:043b\:0435\:0432\:0438\:0442\:0435", " ", 
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
         "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
         "\:043d\:0430", " ", "newA"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", "rows"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eigenvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", " ", 
           RowBox[{"nonzeroVal", "++"}]}], "]"}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "nonzeroVal"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"saved", "=", 
        RowBox[{"nonzeroVal", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"percent", "/", "100"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:0431\:0440\:043e\:044f\:0442", " ", "\:043d\:0430", " ", 
         "\:0437\:0430\:043f\:0430\:0437\:0430\:043d\:0438\:0442\:0435", " ", 
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
         "\:0432\:0435\:043a\:0442\:043e\:0440\:0438", " ", 
         RowBox[{"(", 
          RowBox[{
          "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:044f\:0442\:0430\
", " ", "\:043d\:0430", " ", "A"}], ")"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"singular", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"eigenvalues", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:043f\:0430\:0437\:0435\:043d\:0438\:0442\:0435", " ", 
         "\:0441\:0438\:043d\:0433\:0443\:043b\:044f\:0440\:043d\:0438", " ", 
         "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
         "\:043d\:0430", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
         "\:0440\:0435\:0434\:043e\:0432\:0435", " ", "\:043d\:0430", " ", 
         "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "V", 
         " ", "\:043e\:0442", " ", 
         "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "saved"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{
           RowBox[{"eigenvectors", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"Norm", "[", 
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"\:0441\:0430\:043c\:0430\:0442\:0430", " ", "V"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"U", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
         "\:043a\:043e\:043b\:043e\:043d\:0438", " ", "\:043d\:0430", " ", 
         "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "U", 
         " ", "\:043e\:0442", " ", 
         "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "saved"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{
          RowBox[{"U", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"singular", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Transpose", "[", "A", "]"}], ".", 
             RowBox[{"V", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "U"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"flag", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", 
         "cols", ",", "flag"}], "}"}]}], " ", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:0444\:0438\:043d\:0430\:043b\:043d\:0438\:0442\:0435", " ", 
         "\:0434\:0430\:043d\:043d\:0438"}], ",", " ", 
        RowBox[{
        "\:043a\:043e\:0438\:0442\:043e", " ", 
         "\:043f\:0430\:0437\:0438\:043c"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SVD", "[", 
   RowBox[{"A_", ",", "percent_"}], "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:0440\:0430\:043d\:0435",
     " ", "\:043d\:0430", " ", "\:043c\:0430\:0442\:0440\:0438\:0446\:0430", 
    " ", "\:0441\:044a\:0441", " ", 
    "\:0437\:0430\:0434\:0430\:0434\:0435\:043d\:0430", " ", 
    "\:0442\:043e\:0447\:043d\:043e\:0441\:0442"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"rows", "=", 
     RowBox[{"Length", "[", "A", "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:0440\:0435\:0434\:043e\:0432\:0435\:0442\:0435", " ", "\:043d\:0430", 
      " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"cols", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:043a\:043e\:043b\:043e\:043d\:0438\:0442\:0435", " ", "\:043d\:0430", 
      " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"rows", "\[GreaterEqual]", "cols"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newA", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "A", "]"}], ".", "A"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0441\:0438\:043c\:0435\:0442\:0440\:0438\:0437\:0430\:0446\:0438\
\:044f\:0442\:0430", " ", "\:043d\:0430", " ", "A"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eigenvalues", "=", 
         RowBox[{"Eigenvalues", "[", "newA", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438\:0442\:0435",
           " ", "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ",
           "\:043d\:0430", " ", "newA"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"eigenvectors", "=", 
         RowBox[{"Eigenvectors", "[", "newA", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438\:0442\:0435",
           " ", "\:0432\:0435\:043a\:0442\:043e\:0440\:0438", " ", 
          "\:043d\:0430", " ", "newA"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"QR", "[", "newA", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eigenvalues", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "cols"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eigenvectors", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"temp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"nonzeroVal", "=", "0"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0431\:0440\:043e\:044f\:0447", " ", "\:0437\:0430", " ", 
          "\:043d\:0435\:043d\:0443\:043b\:0435\:0432\:0438\:0442\:0435", " ",
           "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
          "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
          "\:043d\:0430", " ", "newA"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "cols"}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"eigenvalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", " ", 
            RowBox[{"nonzeroVal", "++"}]}], "]"}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "nonzeroVal"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"saved", "=", 
         RowBox[{"nonzeroVal", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"percent", "/", "100"}]}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0431\:0440\:043e\:044f\:0442", " ", "\:043d\:0430", " ", 
          "\:0437\:0430\:043f\:0430\:0437\:0430\:043d\:0438\:0442\:0435", " ",
           "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
          "\:0432\:0435\:043a\:0442\:043e\:0440\:0438", " ", 
          RowBox[{"(", 
           RowBox[{
           "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:044f\:0442\:0430\
", " ", "\:043d\:0430", " ", "A"}], ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"singular", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{"eigenvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:043f\:0430\:0437\:0435\:043d\:0438\:0442\:0435", " ", 
          "\:0441\:0438\:043d\:0433\:0443\:043b\:044f\:0440\:043d\:0438", " ",
           "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
          "\:043d\:0430", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
          "\:0440\:0435\:0434\:043e\:0432\:0435", " ", "\:043d\:0430", " ", 
          "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "V", 
          " ", "\:043e\:0442", " ", 
          "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "saved"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"V", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
           RowBox[{
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"Norm", "[", 
             RowBox[{"eigenvectors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"\:0441\:0430\:043c\:0430\:0442\:0430", " ", "V"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"U", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
          "\:043a\:043e\:043b\:043e\:043d\:0438", " ", "\:043d\:0430", " ", 
          "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "U", 
          " ", "\:043e\:0442", " ", 
          "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "saved"}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"singular", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"A", ".", 
              RowBox[{"V", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "U"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", 
          "cols", ",", "flag"}], "}"}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "\:0444\:0438\:043d\:0430\:043b\:043d\:0438\:0442\:0435", " ", 
          "\:0434\:0430\:043d\:043d\:0438"}], ",", " ", 
         RowBox[{
         "\:043a\:043e\:0438\:0442\:043e", " ", 
          "\:043f\:0430\:0437\:0438\:043c"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", ")"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newA", "=", 
         RowBox[{"A", ".", 
          RowBox[{"Transpose", "[", "A", "]"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0441\:0438\:043c\:0435\:0442\:0440\:0438\:0437\:0430\:0446\:0438\
\:044f\:0442\:0430", " ", "\:043d\:0430", " ", "A"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eigenvalues", "=", 
         RowBox[{"Eigenvalues", "[", "newA", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438\:0442\:0435",
           " ", "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ",
           "\:043d\:0430", " ", "newA"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"eigenvectors", "=", 
         RowBox[{"Eigenvectors", "[", "newA", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438\:0442\:0435",
           " ", "\:0432\:0435\:043a\:0442\:043e\:0440\:0438", " ", 
          "\:043d\:0430", " ", "newA"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"QR", "[", "newA", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eigenvalues", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "cols"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eigenvectors", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"temp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"nonzeroVal", "=", "0"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0431\:0440\:043e\:044f\:0447", " ", "\:0437\:0430", " ", 
          "\:043d\:0435\:043d\:0443\:043b\:0435\:0432\:0438\:0442\:0435", " ",
           "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
          "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
          "\:043d\:0430", " ", "newA"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "rows"}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"eigenvalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", " ", 
            RowBox[{"nonzeroVal", "++"}]}], "]"}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "nonzeroVal"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"saved", "=", 
         RowBox[{"nonzeroVal", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"percent", "/", "100"}]}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0431\:0440\:043e\:044f\:0442", " ", "\:043d\:0430", " ", 
          "\:0437\:0430\:043f\:0430\:0437\:0430\:043d\:0438\:0442\:0435", " ",
           "\:0441\:043e\:0431\:0441\:0442\:0432\:0435\:043d\:0438", " ", 
          "\:0432\:0435\:043a\:0442\:043e\:0440\:0438", " ", 
          RowBox[{"(", 
           RowBox[{
           "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:044f\:0442\:0430\
", " ", "\:043d\:0430", " ", "A"}], ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"singular", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{"eigenvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:043f\:0430\:0437\:0435\:043d\:0438\:0442\:0435", " ", 
          "\:0441\:0438\:043d\:0433\:0443\:043b\:044f\:0440\:043d\:0438", " ",
           "\:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
          "\:043d\:0430", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
          "\:0440\:0435\:0434\:043e\:0432\:0435", " ", "\:043d\:0430", " ", 
          "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "V", 
          " ", "\:043e\:0442", " ", 
          "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "saved"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"V", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
           RowBox[{
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"Norm", "[", 
             RowBox[{"eigenvectors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"\:0441\:0430\:043c\:0430\:0442\:0430", " ", "V"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"U", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", "saved", " ", 
          "\:043a\:043e\:043b\:043e\:043d\:0438", " ", "\:043d\:0430", " ", 
          "\:043c\:0430\:0442\:0440\:0438\:0446\:0430\:0442\:0430", " ", "U", 
          " ", "\:043e\:0442", " ", 
          "\:0434\:0435\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\
\:044f\:0442\:0430"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "saved"}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"singular", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Transpose", "[", "A", "]"}], ".", 
              RowBox[{"V", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"\:0441\:0430\:043c\:043e\:0442\:043e", " ", "U"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"flag", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", 
          "cols", ",", "flag"}], "}"}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "\:0444\:0438\:043d\:0430\:043b\:043d\:0438\:0442\:0435", " ", 
          "\:0434\:0430\:043d\:043d\:0438"}], ",", " ", 
         RowBox[{
         "\:043a\:043e\:0438\:0442\:043e", " ", 
          "\:043f\:0430\:0437\:0438\:043c"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.6732758724295216`*^9, 3.673275904079566*^9}, {
  3.6732759465496254`*^9, 3.6732760331597466`*^9}, {3.673276166329933*^9, 
  3.6732761724499416`*^9}, {3.6732762080299916`*^9, 3.6732762508300514`*^9}, {
  3.6732769399945173`*^9, 3.673276940874519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadSVD", "[", 
   RowBox[{
   "U_", ",", "singular_", ",", "V_", ",", "saved_", ",", "rows_", ",", 
    "cols_", ",", "flag_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"flag", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"singular", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"U", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "rows"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "1"}], "}"}]}], "]"}], ".", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "cols"}], "}"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "saved"}], "}"}]}], "]"}], " ", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"singular", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "rows"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "1"}], "}"}]}], "]"}], ".", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"U", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "cols"}], "}"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "saved"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:044f\:0432\:0435\:043d", " ", "\:0432\:0438\:0434", " ", 
      "\:043d\:0430", " ", 
      "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:0440\:0430\:043d\
\:0430\:0442\:0430", " ", "\:043c\:0430\:0442\:0440\:0438\:0446\:0430"}], " ",
      "*)"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.6732762726800823`*^9, 3.6732763409701777`*^9}, {
  3.673276463610349*^9, 3.673276487372884*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompressMatrix", "[", 
   RowBox[{"A_", ",", "percent_"}], "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:043a\:043e\:043c\:043f\:043e\:0437\:0438\:0446\:0438\:044f", " ", 
    "\:043d\:0430", " ", "\:043f\:044a\:0440\:0432\:0438\:0442\:0435", " ", 
    "2", " ", "\:0444\:0443\:043d\:043a\:0446\:0438\:0438"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", "cols", 
       ",", "flag"}], "}"}], "=", 
     RowBox[{"SVD", "[", 
      RowBox[{"A", ",", "percent"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ReadSVD", "[", 
     RowBox[{
     "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", "cols", 
      ",", "flag"}], "]"}]}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.67327650603291*^9, 3.6732765132329197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompressImage", "[", 
   RowBox[{"image_", ",", "percent_"}], "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:043a\:043e\:043c\:043f\:0440\:0435\:0441\:0438\:0440\:0430\:043d\:0435",
     " ", "\:043d\:0430", " ", 
    "\:0438\:0437\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\:0435"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imageMatrix", "=", 
     RowBox[{"ImageData", "[", "image", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"compressedMatrix", "=", 
     RowBox[{"CompressMatrix", "[", 
      RowBox[{"imageMatrix", ",", "percent"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Image", "[", "compressedMatrix", "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"example", "=", 
   RowBox[{"ExampleData", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<TestImage\>\"", ",", "\"\<Mandrill\>\""}], "}"}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.673281135160817*^9, 3.6732816764615746`*^9, {3.6732824526016693`*^9, 
   3.67328246030168*^9}, {3.6732825014017377`*^9, 3.6732825020017385`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"listImage", "=", 
   RowBox[{"ColorSeparate", "[", "example", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732825072317457`*^9, 3.6732825113517513`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"compressed", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CompressImage", "[", 
      RowBox[{
       RowBox[{"listImage", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "80"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.673282514631756*^9, 3.6732825187917624`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"matrix", "=", 
   RowBox[{"ImageData", "[", 
    RowBox[{"listImage", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732765675529957`*^9, 3.6732765949530344`*^9}, {
  3.6732805056489363`*^9, 3.6732805176589527`*^9}, {3.673280711799225*^9, 
  3.673280715049229*^9}, {3.6732825220917664`*^9, 3.6732825266817727`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "B", ",", "eigenvalues", ",", "eigenvectors", ",", "rows", ",", "cols", 
     ",", "flag"}], "}"}], "=", 
   RowBox[{"QR", "[", 
    RowBox[{"matrix", ",", "1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732776549655185`*^9, 3.6732776768755493`*^9}, {
   3.673280768929305*^9, 3.6732807967993436`*^9}, 3.6732808305693913`*^9, {
   3.673280876920456*^9, 3.6732808911504755`*^9}, {3.6732825292017765`*^9, 
   3.6732825320217805`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", "cols", 
     ",", "flag"}], "}"}], "=", 
   RowBox[{"NewSVD", "[", 
    RowBox[{
    "matrix", ",", "B", ",", "eigenvalues", ",", "eigenvectors", ",", "rows", 
     ",", "cols", ",", "flag", ",", "80"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732794785944967`*^9, 3.6732795244645615`*^9}, {
   3.673279554734604*^9, 3.673279568094622*^9}, {3.6732799939562187`*^9, 
   3.6732800110962424`*^9}, 3.6732801160383906`*^9, 3.67328087272945*^9, {
   3.673282535451785*^9, 3.6732825381917887`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"matrix1", "=", 
   RowBox[{"ReadSVD", "[", 
    RowBox[{
    "U", ",", "singular", ",", "V", ",", "saved", ",", "rows", ",", "cols", 
     ",", "flag"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732795711146264`*^9, 3.673279591094654*^9}, 
   3.673280817399372*^9, {3.6732825412317934`*^9, 3.673282543981797*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Image", "[", "matrix1", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.673279594594659*^9, 3.673279600404668*^9}, {
  3.673282549831805*^9, 3.6732825525118093`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Image", "[", 
   RowBox[{"matrix", "-", "matrix1"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732797313048506`*^9, 3.6732797434148674`*^9}, {
  3.6732798178749723`*^9, 3.673279819514974*^9}, {3.673280386278769*^9, 
  3.6732803908887753`*^9}, {3.6732804300588303`*^9, 3.6732804479988556`*^9}, {
  3.673282555101813*^9, 3.6732825599918194`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Length", "[", "matrix", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.673281600141467*^9, 3.673281602671471*^9}, {
  3.6732817650517*^9, 3.673281778231718*^9}, {3.673282563111824*^9, 
  3.6732825670818295`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Length", "[", 
   RowBox[{"matrix", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6732817801017213`*^9, 3.673281789891735*^9}, {
  3.673282486971717*^9, 3.6732824891017203`*^9}, {3.6732825699118333`*^9, 
  3.673282573231838*^9}}]
},
WindowSize->{1350, 633},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2821, 76, 352, "Input"],
Cell[3381, 98, 1893, 50, 312, "Input"],
Cell[5277, 150, 2718, 68, 392, "Input"],
Cell[7998, 220, 12379, 280, 572, "Input"],
Cell[20380, 502, 17351, 388, 872, "Input"],
Cell[37734, 892, 2897, 77, 172, "Input"],
Cell[40634, 971, 971, 23, 112, "Input"],
Cell[41608, 996, 805, 19, 132, "Input"],
Cell[42416, 1017, 374, 9, 31, "Input"],
Cell[42793, 1028, 199, 4, 31, "Input"],
Cell[42995, 1034, 413, 11, 31, "Input"],
Cell[43411, 1047, 402, 8, 31, "Input"],
Cell[43816, 1057, 516, 12, 31, "Input"],
Cell[44335, 1071, 641, 14, 31, "Input"],
Cell[44979, 1087, 363, 8, 31, "Input"],
Cell[45345, 1097, 206, 4, 31, "Input"],
Cell[45554, 1103, 391, 7, 31, "Input"],
Cell[45948, 1112, 253, 5, 31, "Input"],
Cell[46204, 1119, 313, 7, 31, "Input"]
}
]
*)

(* End of internal cache information *)
